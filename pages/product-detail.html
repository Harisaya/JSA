<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Ti·∫øt S·∫£n Ph·∫©m - DarkHub</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-wrapper">
                <div class="logo">
                    <span class="logo-emoji">üõç</span>
                    <span class="logo-text">DarkHub</span>
                </div>
                <div class="header-right">
                    <a href="index.html" class="nav-link">Trang Ch·ªß</a>
                    <a href="search.html" class="nav-link">T√¨m Ki·∫øm</a>
                    <a href="cart.html" class="nav-link">üõí Gi·ªè H√†ng</a>
                    <a href="orders.html" class="nav-link">üì¶ ƒê∆°n H√†ng</a>
                    <a href="profile.html" class="nav-link">üë§ H·ªì S∆°</a>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="product-detail-container">
                <a href="index.html" class="back-link">‚Üê Quay l·∫°i</a>
                
                <div id="productDetail" class="product-detail">
                    <div class="product-image-section">
                        <img id="productImage" src="" alt="Product" class="product-image">
                    </div>
                    
                    <div class="product-info-section">
                        <h1 id="productName" class="product-title"></h1>
                        
                        <div class="product-rating">
                            <span class="stars" id="productStars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                            <span class="rating-value" id="productRating">4.8</span>
                            <span class="review-count" id="productReviews">(1,250 reviews)</span>
                        </div>
                        
                        <div class="product-price" id="productPrice">AED 35</div>
                        
                        <div class="product-description" id="productDescription">
                            M√¥ t·∫£ s·∫£n ph·∫©m ƒëang ƒë∆∞·ª£c t·∫£i...
                        </div>
                        
                        <div class="product-info">
                            <div class="info-row">
                                <span>üïê Th·ªùi gian giao:</span>
                                <strong id="deliveryTime">30-40 ph√∫t</strong>
                            </div>
                            <div class="info-row">
                                <span>üöö Ph√≠ giao:</span>
                                <strong id="deliveryFee">AED 5</strong>
                            </div>
                            <div class="info-row">
                                <span>üìç ƒê·ªãa ch·ªâ:</span>
                                <strong id="restaurant">Pizza Paradise</strong>
                            </div>
                        </div>
                        
                        <div class="quantity-selector">
                            <button id="decreaseBtn" class="qty-btn">‚àí</button>
                            <input type="number" id="quantity" value="1" min="1" readonly>
                            <button id="increaseBtn" class="qty-btn">+</button>
                        </div>
                        
                        <button id="addToCartBtn" class="add-to-cart-btn">Th√™m v√†o gi·ªè h√†ng</button>
                    </div>
                </div>
                
                <div id="relatedProducts" class="related-products" style="margin-top: 3rem;">
                    <h2 style="color: #f0f0f0; margin-bottom: 1.5rem;">S·∫£n ph·∫©m li√™n quan</h2>
                    <div id="relatedList" class="restaurants-grid"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="config.js"></script>
    <script src="mock-data.js"></script>
    <script src="main.js"></script>
    
    <script>
        // Product Detail Page Script
        let cart = [];
        let currentProduct = null;

        function getProductFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        function displayProduct(productId) {
            const allRestaurants = getMockRestaurants();
            const product = allRestaurants.find(r => r.id == productId);
            
            if (!product) {
                document.getElementById('productDetail').innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #aaa;">S·∫£n ph·∫©m kh√¥ng t√¨m th·∫•y</p>';
                return;
            }

            currentProduct = product;
            
            document.getElementById('productImage').src = product.image;
            document.getElementById('productName').textContent = product.name;
            document.getElementById('productRating').textContent = (product.rating || 4.0).toFixed(1);
            document.getElementById('productReviews').textContent = `(${product.reviews || 0} reviews)`;
            document.getElementById('productPrice').textContent = `AED ${product.minOrder || 35}`;
            document.getElementById('productDescription').textContent = `${product.name} - Nh√† h√†ng chuy√™n v·ªÅ ${(product.cuisines || ['Th·ª±c ph·∫©m']).join(', ')}. ƒê√°nh gi√° cao t·ª´ ${product.reviews || 0} kh√°ch h√†ng. Giao h√†ng nhanh ch√≥ng v√† ƒë√°ng tin c·∫≠y.`;
            document.getElementById('deliveryTime').textContent = product.deliveryTime || '30-40 ph√∫t';
            document.getElementById('deliveryFee').textContent = product.deliveryFee || 'AED 5';
            document.getElementById('restaurant').textContent = product.name;
            
            // Related products (same category)
            const related = allRestaurants.filter(r => r.category === product.category && r.id != productId).slice(0, 4);
            displayRelatedProducts(related);
        }

        function displayRelatedProducts(products) {
            const container = document.getElementById('relatedList');
            if (products.length === 0) {
                container.innerHTML = '<p style="color: #aaa;">Kh√¥ng c√≥ s·∫£n ph·∫©m li√™n quan</p>';
                return;
            }

            container.innerHTML = products.map(product => `
                <a href="product-detail.html?id=${product.id}" style="text-decoration: none; color: inherit;">
                    <div class="restaurant-card" style="cursor: pointer;">
                        <img src="${product.image}" alt="${product.name}" class="restaurant-image">
                        <div class="restaurant-body">
                            <h3 class="restaurant-name">${product.name}</h3>
                            <p style="color: #888; font-size: 0.9rem;">‚≠ê ${(product.rating || 4.0).toFixed(1)} ‚Ä¢ ${product.reviews || 0} reviews</p>
                            <p style="color: #FF006E; font-weight: 600;">Xem chi ti·∫øt ‚Üí</p>
                        </div>
                    </div>
                </a>
            `).join('');
        }

        function updateQuantity(change) {
            const input = document.getElementById('quantity');
            let value = parseInt(input.value) + change;
            if (value >= 1) {
                input.value = value;
            }
        }

        function addToCart() {
            if (!currentProduct) return;

            const quantity = parseInt(document.getElementById('quantity').value);
            const price = parseInt(currentProduct.minOrder?.replace(/[^0-9]/g, '') || 35);
            
            const cartItem = {
                id: currentProduct.id,
                name: currentProduct.name,
                price: price,
                quantity: quantity,
                image: currentProduct.image
            };

            cart.push(cartItem);
            localStorage.setItem('darkhub_cart', JSON.stringify(cart));
            
            showAddedNotification();
        }

        function showAddedNotification() {
            const btn = document.getElementById('addToCartBtn');
            const originalText = btn.textContent;
            btn.textContent = '‚úì ƒê√£ th√™m v√†o gi·ªè h√†ng!';
            btn.style.background = '#10B981';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
            }, 2000);
        }

        // Event Listeners
        document.getElementById('increaseBtn').addEventListener('click', () => updateQuantity(1));
        document.getElementById('decreaseBtn').addEventListener('click', () => updateQuantity(-1));
        document.getElementById('addToCartBtn').addEventListener('click', addToCart);

        // Load cart from localStorage
        const savedCart = localStorage.getItem('darkhub_cart');
        if (savedCart) {
            cart = JSON.parse(savedCart);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const productId = getProductFromURL();
            if (productId) {
                displayProduct(productId);
            } else {
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>
